{
    "meta": {
        "apiVersion": "1.0.0"
    }, 
    "global_settings": {
        "logging": {
            "level": "{{__settings__.logging.loglevel}}"
        }
    }, 
    "tokens": [
        "__settings__.logging.loglevel", 
        "__settings__.additional_parameters.bigfix_server_url", 
        "__settings__.additional_parameters.bigfix_server_port", 
        "global_account.username", 
        "global_account.password", 
        "mac_address_property"
    ], 
    "requests": [
        {
            "iteration_mode": {
                "stop_conditions": [
                    {
                        "input": [
                            "{{__response__.body}}", 
                            "$.result"
                        ], 
                        "method": "json_empty"
                    }
                ], 
                "iteration_count": "1"
            }, 
            "post_process": {
                "skip_conditions": [
                    {
                        "input": [
                            "{{__response__.body}}", 
                            "$.result"
                        ], 
                        "method": "json_empty"
                    }
                ], 
                "pipeline": [
                    {
                        "input": [
                            "{{__response__.body}}", 
                            "$.result"
                        ], 
                        "method": "json_path", 
                        "output": "__stdout__"
                    }, 
                    {
                        "input": [
                            "{{__stdout__}}", 
                            "", 
                            "{{index}}", 
                            "{{host}}", 
                            "{{source}}", 
                            "{{sourcetype}}"
                        ], 
                        "method": "splunk_xml", 
                        "output": "__stdout__"
                    }, 
                    {
                        "input": [
                            "{{__stdout__}}"
                        ], 
                        "method": "std_output"
                    }
                ]
            }, 
            "request": {
                "headers": {}, 
                "method": "GET", 
                "url": "{{__settings__.additional_parameters.bigfix_server_url}}:{{__settings__.additional_parameters.bigfix_server_port}}/api/query?output=json&relevance=%28%22nt_host%3D%22+%26+%28name+of+item+0+of+it+%7C+%22missing+Name%22%29+%2C+%22last_report_time%3D%22+%26+concatenation+%22%7C%22+of+values+of+results+%28item+0+of+it+%2C+elements+of+item+1+of+it%29+%2C+%22ip%3D%22+%26+%28if+%28size+of+item+2+of+it+%3D+1%29+then+%28concatenation+%22%7C%22+of+values+whose+%28it+as+string+does+not+start+with+%22169.254%22%29+of+results+%28item+0+of+it+%2C+elements+of+item+2+of+it%29%29+else+%28if+%28size+of+item+2+of+it+%3E+1%29+then+%28%28%22IP+Address+property+duplicates%3A+%22+%26+concatenation+%22%7C%22+of+%28%28name+of+it%29+%26+%22%3D%22+%26+%28id+of+it+as+string%29%29+of+elements+of+item+2+of+it%29+as+string%29+else+%28%22%22%29%29%29+%2C+%22mac%3D%22+%26+%28if+%28size+of+item+3+of+it+%3D+1%29+then+%28concatenation+%22%7C%22+of+values+of+results+%28item+0+of+it+%2C+elements+of+item+3+of+it%29%29+else+%28if+%28size+of+item+3+of+it+%3E+1%29+then+%28%28%22Property+3+duplicates%3A+%22+%26+concatenation+%22%7C%22+of+%28%28name+of+it%29+%26+%22%3D%22+%26+%28id+of+it+as+string%29%29+of+elements+of+item+3+of+it%29+as+string%29+else+%28%22%22%29%29%29+%2C+%22dns%3D%22+%26+%28if+%28size+of+item+4+of+it+%3D+1%29+then+%28%28if+it+%3D+%22%22+then+%22%22+else+it%29+of+concatenation+%22%7C%22+of+values+of+results+%28item+0+of+it+%2C+elements+of+item+4+of+it%29%29+else+%28if+%28size+of+item+3+of+it+%3E+1%29+then+%28%28%22Property+3+duplicates%3A+%22+%26+concatenation+%22%7C%22+of+%28%28name+of+it%29+%26+%22%3D%22+%26+%28id+of+it+as+string%29%29+of+elements+of+item+3+of+it%29+as+string%29+else+%28%22%22%29%29%29+%2C+%22operating_system%3D%22+%26+concatenation+%22%7C%22+of+values+of+results+%28item+0+of+it+%2C+elements+of+item+5+of+it%29+%2C+%28%22user%3D%22+%26+concatenation+%22%7C%22+of+values+of+results+%28item+0+of+it+%2C+elements+of+item+6+of+it%29%29+%2C+%28%22client_version%3D%22+%26+value+of+result+%28item+0+of+it+%2C+elements+of+item+7+of+it%29%29+%2C+%22relay_server%3D%22+%26+%28if+%28exists+relay+server+of+item+0+of+it%29+then+relay+server+of+item+0+of+it+else+%22none%22%29+%2C+%22relay_distance%3D%22+%26+%28if+%28exists+relay+distance+of+item+0+of+it%29+then+relay+distance+of+item+0+of+it+as+string+else+%22none%22%29+%2C+%22relay_selection_method%3D%22+%26+%28if+%28exists+relay+selection+method+of+item+0+of+it%29+then+relay+selection+method+of+item+0+of+it+else+%22none%22%29+%2C+%22is_relay%3D%22+%26+%28if+%28exists+relay+server+flag+of+item+0+of+it%29+then+relay+server+flag+of+item+0+of+it+as+string+else+%22none%22%29+%2C+%28%22relay_version%3D%22+%26+%28if+%28value+of+result+%28item+0+of+it+%2C+bes+property+%22BES+Relay+Version%22%29+%3D+%22Not+Installed%22%29+or+%28value+of+result+%28item+0+of+it+%2C+bes+property+%22BES+Relay+Version%22%29+%3D+%22N%2FA%22%29+then+%22%22+else+%28value+of+result+%28item+0+of+it+%2C+bes+property+%22BES+Relay+Version%22%29%29%29%29+%2C+%28%22server_version%3D%22+%26+%28if+%28value+of+result+%28item+0+of+it+%2C+bes+property+%22BES+Server+Version%22%29+%3D+%22Not+Installed%22%29+or+%28value+of+result+%28item+0+of+it+%2C+bes+property+%22BES+Server+Version%22%29+%3D+%22N%2FA%22%29+then+%22%22+else+%28value+of+result+%28item+0+of+it+%2C+bes+property+%22BES+Server+Version%22%29%29%29%29%29+of+%28elements+of+item+0+of+it+%2C+item+1+of+it+%2C+item+2+of+it+%2C+item+3+of+it+%2C+item+4+of+it+%2C+item+5+of+it+%2C+item+6+of+it+%2C+item+7+of+it%29+of+%28set+of+BES+computers+%2C+set+of+bes+properties+whose+%28name+of+it+as+lowercase+%3D+%28%22Last+Report+Time%22%29+as+lowercase%29+%2C+set+of+bes+properties+whose+%28reserved+flag+of+it+and+name+of+it+as+lowercase+%3D+%28%22ip+address%22%29%29+%2C+set+of+bes+properties+whose+%28name+of+it+as+lowercase+%3D+%28%22{{mac_address_property}}%22%29+as+lowercase%29+%2C+set+of+bes+properties+whose+%28reserved+flag+of+it+and+name+of+it+as+lowercase+%3D+%28%22dns+name%22%29%29+%2C+set+of+bes+properties+whose+%28reserved+flag+of+it+and+name+of+it+as+lowercase+%3D+%28%22os%22%29%29+%2C+set+of+bes+properties+whose+%28name+of+it+as+lowercase+%3D+%28%22user+name%22%29%29+%2C+set+of+bes+properties+whose+%28name+of+it+as+lowercase+%3D+%28%22bes+client+version%22%29%29%29+", 
                "auth": {
                    "options": {
                        "password": "{{global_account.password}}", 
                        "username": "{{global_account.username}}"
                    }, 
                    "type": "basic_auth"
                }
            }, 
            "pre_process": {
                "skip_conditions": [], 
                "pipeline": []
            }
        }
    ]
}