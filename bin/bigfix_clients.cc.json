{
    "tokens": [
        "__settings__.logging.loglevel", 
        "__settings__.additional_parameters.bigfix_server_port", 
        "__settings__.additional_parameters.bigfix_server_url", 
        "global_account.username", 
        "global_account.password", 
        "mac_address_property"
    ], 
    "global_settings": {
        "logging": {
            "level": "{{__settings__.logging.loglevel}}"
        }
    }, 
    "requests": [
        {
            "post_process": {
                "skip_conditions": [
                    {
                        "input": [
                            "{{__response__.body}}", 
                            "$.$.result[*]"
                        ], 
                        "method": "json_empty"
                    }
                ], 
                "pipeline": [
                    {
                        "input": [
                            "{{__response__.body}}", 
                            "$.$.result[*]"
                        ], 
                        "method": "json_path", 
                        "output": "__stdout__"
                    }, 
                    {
                        "input": [
                            "{{__stdout__}}", 
                            "", 
                            "{{index}}", 
                            "{{host}}", 
                            "{{source}}", 
                            "{{sourcetype}}"
                        ], 
                        "method": "splunk_xml", 
                        "output": "__stdout__"
                    }, 
                    {
                        "input": [
                            "{{__stdout__}}"
                        ], 
                        "method": "std_output"
                    }
                ]
            }, 
            "request": {
                "url": "{{__settings__.additional_parameters.bigfix_server_url}}:{{__settings__.additional_parameters.bigfix_server_port}}/api/query?output=json&relevance=(\"nt_host=\" %26 (name of item 0 of it | \"missing Name\"),\"client_id=\" %26 id of item 0 of it as string, \"last_report_time=\" %26 concatenation \"|\" of values of results (item 0 of it , elements of item 1 of it),\"ip=\" %26 (if (size of item 2 of it = 1) then (concatenation \"|\" of values whose (it as string does not start with \"169.254\") of results (item 0 of it , elements of item 3 of it)) else (if (size of item 3 of it > 1) then ((\"IP Address property duplicates: \" %26 concatenation \"|\" of ((name of it) %26 \"=\" %26 (id of it as string)) of elements of item 3 of it) as string) else (\"\"))), \"mac=\" %26 (concatenation \"|\" of values of results (item 0 of it , elements of item 4 of it)|\"\"),\"dns=\" %26 (if (size of item 4 of it = 1) then ((if it = \"\" then \"\" else it) of concatenation \"|\" of values of results (item 0 of it , elements of item 5 of it)) else (if (size of item 3 of it > 1) then ((\"Property 3 duplicates: \" %26 concatenation \"|\" of ((name of it) %26 \"=\" %26 (id of it as string)) of elements of item 3 of it) as string) else (\"\"))) , \"operating_system=\" %26 concatenation \"|\" of values of results (item 0 of it , elements of item 6 of it),(\"user=\" %26 concatenation \"|\" of values of results (item 0 of it , elements of item 7 of it)),(\"client_version=\" %26 (value of result (item 0 of it , elements of item 8 of it))), \"subscribed_sites=\" %26 concatenation \"|\" of display names of subscribed sites whose (custom site flag of it OR external site flag of it) of item 0 of it) of (elements of item 0 of it , item 1 of it , item 2 of it , item 3 of it , item 4 of it , item 5 of it , item 6 of it , item 7 of it, item 8 of it) of (set of BES computers, set of bes properties whose (name of it as lowercase = (\"Last Report Time\") as lowercase), set of bes properties whose (reserved flag of it AND name of it as lowercase = (\"id\")), set of bes properties whose (reserved flag of it and name of it as lowercase = (\"ip address\")) , (set of bes properties whose (name of it as lowercase = (\"{{mac_address_property}}\") as lowercase)) , set of bes properties whose (reserved flag of it and name of it as lowercase = (\"dns name\")) , set of bes properties whose (reserved flag of it and name of it as lowercase = (\"os\")) , (set of bes properties whose (name of it as lowercase = (\"user name\"))), set of bes properties whose (reserved flag of it AND name of it as lowercase = (\"agent version\")))", 
                "headers": {}, 
                "method": "GET", 
                "auth": {
                    "type": "basic_auth", 
                    "options": {
                        "username": "{{global_account.username}}", 
                        "password": "{{global_account.password}}"
                    }
                }
            }, 
            "pre_process": {
                "skip_conditions": [], 
                "pipeline": []
            }, 
            "iteration_mode": {
                "iteration_count": "1", 
                "stop_conditions": [
                    {
                        "input": [
                            "{{__response__.body}}", 
                            "$.$.result[*]"
                        ], 
                        "method": "json_empty"
                    }
                ]
            }
        }
    ], 
    "meta": {
        "apiVersion": "1.0.0"
    }
}